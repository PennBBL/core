{{#models}}
{{#model}}
classdef {{classname}} < ModelBase
    % {{classname}}
    {{#description}}
    % {{{.}}}
    {{/description}}
    %
    % {{classname}} Properties:
    {{#vars}}
    %    {{name}} {{#description}} - {{{.}}}{{/description}}
    {{/vars}}
    %
    % {{classname}} Methods:
    %    toJson - Convert the object to a Map that can be encoded to json
    %    struct - Convert the object to a struct
    properties (Constant)
        {{#hasVars}}
        propertyMap = containers.Map({ {{#vars}}'{{name}}'{{#hasMore}}, {{/hasMore}}{{/vars}} }, ...
            { {{#vars}}'{{baseName}}'{{#hasMore}}, {{/hasMore}}{{/vars}} })
        {{/hasVars}}
        {{^hasVars}}
        propertyMap = [];
        {{/hasVars}}
    end
    methods
        function obj = {{classname}}(varargin)
            obj@ModelBase({{classname}}.propertyMap);

            p = inputParser;
            {{#vars}}
            addParameter(p, '{{name}}', {{#defaultValue}}{{defaultValue}}{{/defaultValue}}{{^defaultValue}}[]{{/defaultValue}});
            {{/vars}}
            {{^vars}}
            p.KeepUnmatched = true;
            {{/vars}}

            parse(p, varargin{:});

            {{#vars}}
            if ~isempty(p.Results.{{name}})
                obj.props_('{{baseName}}') = p.Results.{{name}};
            end
            {{/vars}}
            {{^vars}}
            names = fieldnames(p.Unmatched);
            for i = 1:length(names)
                name = names{i};
                obj.props_(name) = p.Unmatched.(name);
            end
            {{/vars}}
        end
        function result = toJson(obj)
            {{#hasVars}}
            result = containers.Map;
            {{/hasVars}}
            {{#vars}}
            if isKey(obj.props_, '{{baseName}}')
                {{#isPrimitiveType}}
                result('{{baseName}}') = obj.props_('{{baseName}}');
                {{/isPrimitiveType}}
                {{^isPrimitiveType}}
                {{^isListContainer}}
                result('{{baseName}}') = obj.props_('{{baseName}}').toJson();
                {{/isListContainer}}
                {{#isListContainer}}
                result('{{baseName}}') = cellfun(@(x) x.toJson(), obj.props_('{{baseName}}'), 'UniformOutput', false);
                {{/isListContainer}}
                {{/isPrimitiveType}}
            end
            {{/vars}}
            {{^vars}}
            {{#vendorExtensions.x-matlab-additionalProperties}}
            result = containers.Map;
            propKeys = keys(obj.props_);
            for i = 1:length(propKeys)
                key = propKeys{i};
                {{#isPrimitiveType}}
                result(key) = obj.props_(key);
                {{/isPrimitiveType}}
                {{^isPrimitiveType}}
                {{^isListContainer}}
                result(key) = obj.props_(key).toJson();
                {{/isListContainer}}
                {{#isListContainer}}
                result(key) = cellfun(@(x) x.toJson(), obj.props_(key), 'UniformOutput', false);
                {{/isListContainer}}
                {{/isPrimitiveType}}
            end
            {{/vendorExtensions.x-matlab-additionalProperties}}
            {{^additionalPropertiesType}}
            result = obj.props_;
            {{/additionalPropertiesType}}
            {{/vars}}
        end
        function result = struct(obj)
            result = struct;

            {{#vars}}
            if isKey(obj.props_, '{{baseName}}')
                {{#isPrimitiveType}}
                result.{{name}} = obj.props_('{{baseName}}');
                {{/isPrimitiveType}}
                {{^isPrimitiveType}}
                {{^isListContainer}}
                result.{{name}} = struct(obj.props_('{{baseName}}'));
                {{/isListContainer}}
                {{#isListContainer}}
                result.{{name}} = cellfun(@(x) struct(x), obj.props_('{{baseName}}'));
                {{/isListContainer}}
                {{/isPrimitiveType}}
            else
                result.{{name}} = {};
            end
            {{/vars}}
            {{^vars}}
            propKeys = keys(obj.props_);
            for i = 1:length(propKeys)
                key = propKeys{i};
                {{#vendorExtensions.x-matlab-additionalProperties}}
                {{#isPrimitiveType}}
                result.(key) = obj.props_(key);
                {{/isPrimitiveType}}
                {{^isPrimitiveType}}
                {{^isListContainer}}
                result.(key) = struct(obj.props_(key));
                {{/isListContainer}}
                {{#isListContainer}}
                result.(key) = cellfun(@(x) struct(x), obj.props_(key), 'UniformOutput', false);
                {{/isListContainer}}
                {{/isPrimitiveType}}
                {{/vendorExtensions.x-matlab-additionalProperties}}
                {{^additionalPropertiesType}}
                result.(key) = obj.props_(key);
                {{/additionalPropertiesType}}
            end
            {{/vars}}
        end
    end
    methods(Access = protected)
        function prpgrp = getPropertyGroups(obj)
            if ~isscalar(obj)
                prpgrp = getPropertyGroups@matlab.mixin.CustomDisplay(obj);
            else
                propList = struct;
                {{#vars}}
                if isKey(obj.props_, '{{baseName}}')
                    propList.{{name}} = obj.props_('{{baseName}}');
                else
                    propList.{{name}} = [];
                end
                {{/vars}}
                {{^vars}}
                propKeys = keys(obj.props_);
                for i = 1:length(propKeys)
                    key = propKeys{i};
                    propList.(key) = obj.props_(key);
                end
                {{/vars}}
                prpgrp = matlab.mixin.util.PropertyGroup(propList);
            end
        end
    end
    methods(Static)
        function obj = fromJson(json)
            obj = {{classname}};
            {{#vars}}
            if isfield(json, '{{vendorExtensions.x-matlab-baseName}}')
                {{#isPrimitiveType}}
                obj.props_('{{baseName}}') = json.{{vendorExtensions.x-matlab-baseName}};
                {{/isPrimitiveType}}
                {{^isPrimitiveType}}
                {{^isListContainer}}
                obj.props_('{{baseName}}') = {{complexType}}.fromJson(json.{{vendorExtensions.x-matlab-baseName}});
                {{/isListContainer}}
                {{#isListContainer}}
                obj.props_('{{baseName}}') = arrayfun(@(x) {{complexType}}.fromJson(x), json.{{vendorExtensions.x-matlab-baseName}}, 'UniformOutput', false);
                {{/isListContainer}}
                {{/isPrimitiveType}}
            end
            {{/vars}}
            {{^vars}}
            names = fieldnames(json);
            for i = 1:length(names)
                name = names{i};
                {{#vendorExtensions.x-matlab-additionalProperties}}
                {{#isPrimitiveType}}
                obj.props_(name) = json.(name);
                {{/isPrimitiveType}}
                {{^isPrimitiveType}}
                {{^isListContainer}}
                obj.props_(name) = {{complexType}}.fromJson(json.(name));
                {{/isListContainer}}
                {{#isListContainer}}
                obj.props_(name) = arrayfun(@(x) {{complexType}}.fromJson(x), json.(name), 'UniformOutput', false);
                {{/isListContainer}}
                {{/isPrimitiveType}}
                {{/vendorExtensions.x-matlab-additionalProperties}}
                {{^additionalPropertiesType}}
                obj.props_(name) = json.(name);
                {{/additionalPropertiesType}}
            end
            {{/vars}}
        end
        function obj = ensureIsInstance(obj)
            if ~isempty(obj)
                % Realistically, we only convert structs
                if isstruct(obj)
                    obj = {{classname}}(obj);
                end
                {{#vars}}
                {{^isPrimitiveType}}
                {{^isListContainer}}
                obj.props_('{{baseName}}') = {{complexType}}.ensureIsInstance(obj.props_('{{baseName}}'));
                {{/isListContainer}}
                {{#isListContainer}}
                obj.props_('{{baseName}}') = ModelBase.cellmap(@(x) {{complexType}}.ensureIsInstance(x), obj.props_('{{baseName}}'));
                {{/isListContainer}}
                {{/isPrimitiveType}}
                {{/vars}}
                {{^vars}}
                {{#vendorExtensions.x-matlab-additionalProperties}}
                {{^isPrimitiveType}}
                propKeys = keys(obj.props_);
                for i = 1:length(propKeys)
                    key = propKeys{i};
                    {{^isListContainer}}
                    obj.props_(key) = {{complexType}}.ensureIsInstance(obj.props_(key));
                    {{/isListContainer}}
                    {{#isListContainer}}
                    obj.props_(key) = ModelBase.cellmap(@(x) {{complexType}}.ensureIsInstance(x), obj.props_(key));
                    {{/isListContainer}}
                end
                {{/isPrimitiveType}}
                {{/vendorExtensions.x-matlab-additionalProperties}}
                {{/vars}}
            end
        end
    end
end
{{/model}}
{{/models}}
